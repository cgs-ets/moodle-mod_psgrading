define(["jquery","core/log","core/ajax"],function(o,a){"use strict";function i(e){var t=this;t.rootel=e,t.rootel=e,t.rootel=e}return i.prototype.main=function(a,e){var i=this;i.rootel.on("change",".group-select",function(e){console.log("Changing group");var t=o(this).find(":selected").data("markurl");t&&window.location.replace(t)});var s=e+1;window.onmessage=function(e){if("saveshownext"==e.data){var t=document.getElementById("quickmark-a"),n=document.getElementById("quickmark-b");if(t.classList.contains("last")||n.classList.contains("last"))return i.setup(a,0),void(s=1);e=null,e=n.classList.contains("hidden")?(t.classList.add("hidden"),n.classList.remove("hidden"),t):(n.classList.add("hidden"),t.classList.remove("hidden"),n);++s>=a.length?(console.log("Last user has been loaded: "+a[s-1]),e.classList.add("last")):(console.log("Loading next hidden url: "+a[s]),e.innerHTML="",(n=document.createElement("iframe")).setAttribute("src",a[s]),e.appendChild(n))}},i.setup(a,e)},i.prototype.setup=function(e,t){var n,a;e.length>t&&((n=document.createElement("iframe")).setAttribute("src",e[t]),(a=document.getElementById("quickmark-a")).innerHTML="",a.appendChild(n),a.classList.remove("hidden"),a.classList.remove("last"),1==e.length&&a.classList.add("last")),e.length>t+1&&((n=document.createElement("iframe")).setAttribute("src",e[t+1]),(a=document.getElementById("quickmark-b")).innerHTML="",a.appendChild(n),a.classList.add("hidden"),a.classList.remove("last"))},{init:function(e,t){a.debug("mod_psgrading/quickmark: initializing");var n=o("#page-mod-psgrading-quickmark");n.length?new i(n).main(e,t):a.error("mod_psgrading/quickmark: #page-mod-psgrading-quickmark not found!")}}});