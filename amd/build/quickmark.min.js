define(["jquery","core/log","core/ajax"],function(o,s){"use strict";function i(e){var t=this;t.rootel=e,t.rootel=e,t.rootel=e}return i.prototype.main=function(s,e){var i=this;i.rootel.on("change",".group-select",function(e){console.log("Changing group");var t=o(this).find(":selected").data("markurl");t&&window.location.replace(t)});var a=e+1;window.onmessage=function(e){if("saveshownext"==e.data){var t=document.getElementById("quickmark-a"),n=document.getElementById("quickmark-b");if(t.classList.contains("last")||n.classList.contains("last"))return i.setup(s,0),void(a=1);e=null,e=n.classList.contains("hidden")?(t.classList.add("hidden"),n.classList.remove("hidden"),t):(n.classList.add("hidden"),t.classList.remove("hidden"),n);++a>=s.length?(console.log("Last user has been loaded: "+s[a-1]),e.classList.add("last")):(console.log("Loading next hidden url: "+s[a]),e.firstElementChild.setAttribute("src",s[a]))}},i.setup(s,e)},i.prototype.setup=function(e,t){var n,s;e.length>t&&((n=document.createElement("iframe")).setAttribute("src",e[t]),(s=document.getElementById("quickmark-a")).innerHTML="",s.appendChild(n),s.classList.remove("hidden"),s.classList.remove("last"),1==e.length&&s.classList.add("last")),e.length>t+1&&((n=document.createElement("iframe")).setAttribute("src",e[t+1]),(s=document.getElementById("quickmark-b")).innerHTML="",s.appendChild(n),s.classList.add("hidden"),s.classList.remove("last"))},{init:function(e,t){s.debug("mod_psgrading/quickmark: initializing");var n=o("#page-mod-psgrading-quickmark");n.length?new i(n).main(e,t):s.error("mod_psgrading/quickmark: #page-mod-psgrading-quickmark not found!")}}});